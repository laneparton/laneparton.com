---
import { Image } from "astro:assets";
import logo from "../assets/images/logo.svg";
import { Icon } from "astro-icon";

const navLinks = [
  {
    text: "Home",
    to: "/",
  },
  {
    text: "About Me",
    to: "/about-me",
  },
  {
    text: "Consulting",
    to: "/consulting",
  },
  {
    text: "Posts",
    to: "/posts",
  },
];
---

<script>
  function toggleNav() {
    const navDrawer = document.getElementById("nav-drawer");
    if (navDrawer?.classList.contains("show")) {
      navDrawer?.classList.remove("show");
    } else {
      navDrawer?.classList.add("show");
    }

    const backdrop = document.getElementById("backdrop");
    backdrop?.addEventListener("click", () => toggleNav());
    if (backdrop?.classList.contains("show")) {
      backdrop?.classList.remove("show");
    } else {
      backdrop?.classList.add("show");
    }
  }

  const navbar = document.getElementById("topnav");
  window.addEventListener('scroll', handleScroll)
  function handleScroll() {
    if (navbar) {
      if (window.scrollY >= 50) {
        navbar.classList.add("sticky-shadow");
      } else {
        navbar.classList.remove("sticky-shadow");
      }
    }
  }

  const navButton = document.getElementsByClassName("nav-button")[0];
  navButton.addEventListener("click", () => toggleNav());

  const navClose = document.getElementById("close-nav");
  navClose?.addEventListener("click", () => toggleNav());
</script>

<header id="topnav" class="w-full fixed z-10 top-0 px-4 bg-midnightBlue">
  <div class="container flex py-4">
    <a class="flex items-center font-normal text-gray-900" href="/">
      <Image src={logo} alt="Logo" width="46" height="46" />
      <span class="ml-4 text-white text-2xl tracking-wider">lane parton</span>
    </a>
    <button type="button" aria-controls="nav-drawer" class="ml-auto nav-button">
      <Icon name="fa-solid:bars" />
    </button>

    <div
      id="nav-drawer"
      class="fixed inset-y-0 z-50 right-0 w-full lg:w-96 bg-midnightBlue shadow-lg transform ease-in-out duration-300 translate-x-full"
      tabindex="-1"
    >
      <div class="px-4 border-b flex border-faintBlue">
        <button
          type="button"
          class="mr-4 ml-auto text-3xl py-4 text-white"
          data-bs-dismiss="offcanvas"
          aria-label="Close"
        >
          <Icon name="ic:round-close" id="close-nav" />
        </button>
      </div>
      <div class="h-full flex items-center justify-center">
        <ul class="text-center">
          {
            navLinks.map((link) => (
              <li class="py-4 text-xl uppercase font-bold">
                <a href={link.to}>{link.text}</a>
              </li>
            ))
          }
        </ul>
      </div>
    </div>
  </div>
  <div
    id="backdrop"
    class="fixed inset-0 z-40 bg-black opacity-0 transition-opacity duration-300 pointer-events-none"
  >
  </div>
</header>

<style>
  .sticky-shadow {
    box-shadow: 0 0 3px rgba(173, 181, 189, 0.15);
  }

  #nav-drawer.show {
    @apply translate-x-0 visible;
  }

  #backdrop.show {
    @apply opacity-75 pointer-events-auto;
  }

  .nav-button {
    @apply text-white bg-lightOrange rounded-sm;
    height: 40px;
    width: 40px;
    display: inline-block;
    line-height: 24px;
  }
</style>
